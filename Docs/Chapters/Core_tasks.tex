\section{Opis sposobu zarządzanie zadaniami w systemie dwurdzeniowym analizatora}

Analizator stanów logicznych ze względu na bardzo rozbudowany system kontrolno-pomiarowy
został zaprojektowany tak aby podzielić konieczne do zrealizowania zadania na dwa dostępne rdzenie.

Rdzeń 0 jest głównym rdzeniem (masterem), który pełni nadrzędną rolę w sterowaniu całym urządzeniem,
natomiast rdzeń 1 pełni rolę podrzędną (slave'a) odpowiedzialnego za komunikację bezprzewodową oraz akwizycje danych analogowych.
Dokładny opis zadań realizowanych przez poszczególne rdzenie przedstawiono poniżej.

\begin{enumerate}
    \item Rdzeń 0\\
    Rdzeń 0 (podstawowy rdzeń mikrokontrolera rp2040) odpowiedzialny jest min. za:
    \begin{enumerate}[label=\arabic*.]
        \item oczekiwanie na sygnał wyzwalający pomiar (trigger),
        \item zapisanie czasu pomiędzy wystąpieniami sygnału trigger (opcjonalnie),
        \item zbieranie danych z wejść cyfrowych z wykorzystaniem DMA,
        \item wysyłanie zebranych danych pomiarowych przez interfejs USB do komputera użytkownika.
    \end{enumerate}

    \item Rdzeń 1 -- odpowiedzialny jest za:
    \begin{enumerate}[label=\arabic*.]
        \item próbkowanie sygnału z kanału 1 przetwornika ADC ADS1115,
        \item próbkowanie sygnału z kanału 1 przetwornika ADC ADS1115,
        \item próbkowanie sygnału z kanału 3 wbudowanego przetwornika ADC RP2040,
        \item próbkowanie sygnału z kanału 4 wbudowanego przetwornika ADC RP2040,
        \item wysyłanie zebranych danych przez WIFI do komputera użytkownika,
        \item wysyłanie zebranych danych pomiarowych do rdzenia 0,
        \item wysyłanie odebranych danych sterujących do rdzenia 0 (jeżeli takie odebrano),
        \item odbieranie danych sterujących od aplikacji użytkownika,
        \item przydzielanie adresu IP użytkownikowi który połączy się z analizatorem.
    \end{enumerate}

    \newpage
    \item Komunikacja między rdzeniem 0 i rdzeniem 1
    \begin{figure}[H]
    \centering
    \begin{tikzpicture}[
        corebox/.style={
            rectangle,
            draw=blue!55,
            line width=1mm,
            fill=blue!20,
            rounded corners,
            minimum width=7cm,
            minimum height=10cm,
            align=left,
            text width=6cm,
            font=\bfseries
        },
        arrow/.style={
            <->,
            ultra thick,
            draw=blue!70
        }
    ]

    % Box for Core 0
    \node[corebox, label=above:{\textbf{Rdzeń 0}}] (core0) {
        \begin{enumerate}
            \item Czekaj na sygnał wyzwalający (trigger)
            \item Zapisz czas między wystąpieniami sygnału trigger (opcjonalnie) 
            \item Zbierz dane z wejść cyfrowych z wykorzystaniem DMA
            \item Wyślij zebrane dane przez interfejs USB do komputera użytkownika
        \end{enumerate}
    };

    % Box for Core 1
    \node[corebox, right=3cm of core0, label=above:{\textbf{Rdzeń 1}}] (core1) {
        \begin{enumerate}
            \item Zbierz dane z przetworników ADS1115 oraz Pico ADC
            \item Wyślij zebrane dane przez Wi-Fi do komputera użytkownika
            \item Wyślij zebrane dane do rdzenia 0
            \item Odbierz dane sterujące(jeżeli take są)
            \item Przydziel adres IP użytkownikowi
        \end{enumerate}
    };

    % Arrow between cores
    \draw[arrow] (core0.east) -- node[above, font=\bfseries] {FIFO} (core1.west);

    \end{tikzpicture}
    \caption{Podział zadań między rdzeniami mikrokontrolera}
\end{figure}


\end{enumerate}

